# Audit and accountability management policy

CivicActions develops, documents, and disseminates to all CivicActions staff the Audit and
Accountability Policy which addresses purpose, scope, roles, responsibilities, management
commitment, coordination among organizational entities, compliance, and procedures to
facilitate the implementation of the audit and accountability policy and associated audit
controls.  The CivicActions Audit and Accountability Policy is maintained in the
CivicActions compliance-docs Github repository is accessible to all CivicActions staff.

The CivicActions Audit and Accountability Policy covers:

* Access Control (AC)
* Audit and Accountability (AU)
* Identification and Authentication (IA)
* System and Communications Protection (SC)

## Purpose

Ensure all actions taken on the information system are transparent, valid, and prevent repudiation. 

## Scope

See the [CivicActions Common Control Policy](CivicActions-Common-Control-Policy.md).

## Policy overlay

For information on roles and responsibilities, management commitment, coordination among
organizational entities, compliance, reviews, and updates please see the
[CivicActions Common Control Policy](CivicActions-Common-Control-Policy.md).

In addition, the CivicActions Information Security will coordinate with CivicActions
client services as needed.

## Procedures

The procedures for auditing CivicActions and client services systems are specific to the
technology stack and as such are described - when needed - in client-specific
documentation.

Audit logs will be made available to client organizations and for mutual support in
response to security breaches, system and user access and incident reporting.

Client services and application system owners are responsible for making sure audit events
are captured based on AU-2(d) parameter requirements for their web applications.

See AU-2.

CivicActions Information Security updates the defined auditable events when changes in the
threat environment occur or are identified by risk assessment.

See AU-2(3).

CloudTrail, CloudWatch, Snort, Tripwire, Clam AV, and Riemann collect, monitor, and maintain audit logs for both AWS and cloud.gov.

The events monitored generally include but are not limited to successful and unsuccessful account logon events, account management events, policy change, privilege functions, and system events. These events are tracked for all administrator activity, authentication checks, authorization checks, and permission changes. 

See AU-3.

The log management framework provides the capability to retain logs for 180 days online, with sufficient capacity as to mitigate the risk of exceeding storage space. In the event the threshold is exceeded, administrators can add additional storage capacity without impacting the system.

See AU-4.

CivicActions has the ability to implement alerting to notify of insufficient audit storage capacity or if no new logs have been written a logging facility within a five-minute timeframe.

See AU-5.

Through the use of CloudTrail, CloudWatch, BOSH, Nessus, ClamAV, Snort, GitHub, and the ELK logging system, the Cloud Operations team monitors and reviews audit logs for unapproved and unusual activities on a continual basis.

We use reporting rulesets developed by the Snort, Nessus and ClamAV teams, which look for, identify, and report potentially inappropriate or unusual activity to be reviewed regularly. In all cases, these tools scan for deviations from historical traffic patterns either in type or quantity.
Security vulnerabilities and system inconsistencies are reviewed by the Cloud Operations team (notified by email, text message and voice phone call).  Security vulnerabilities which are not classified as high are reviewed weekly and resolved by Cloud Operations. Regular security reports are automatically generated by Nessus and sent to the System Owner, GSA’s Information Security team and other partner agencies as required. 
See SI procedures for more detail.

The Cloud Operations team acts on findings that result from its regular audit process according to its incident response guidelines (https://docs.cloud.gov/ops/security-ir), including notifying GSA Information Security, the System Owner, and the ISSO.

See AU-6.

cloud.gov uses the automated mechanisms CloudTrail, CloudWatch, and Riemann to integrate audit monitoring, analysis and reporting into an overall process for investigation and response to suspicious activities. Riemann receives data from multiple sources and makes that data available for regular auditing.

Cloud Operations employs automated CloudWatch logs to collect and track metrics to monitor in real time infrastructure log data and resources. 

See AU-6(1).

Cloud Operations and GSA Information Security have set up comprehensive and automated systems, detailed in the sections under cloud.gov Security Domain Stack. Audit records are under constant analysis, and can be immediately correlated across any tool.

See AU-6(3).

CloudWatch Logs provides on-demand audit review for any actions taken on or in the AWS environment. 

Riemann, InfluxDB, and Grafana provide the capability to evaluate any action taken on the cloud.gov layer. 

The ELK stack, which captures logs related to applications hosted on top of cloud.gov, has the capability to provide audit reduction, analysis, and report generation capability. Specifically, Kibana has the capacity to build search queries on numerous criteria regarding application logs, and produce reports and exports.
CloudWatch Logs, Riemann, InfluxDB, Grafana, and ELK do not alter the original content or time ordering of audit records. All audit files can be viewed in their raw and JSON standard formats.

See AU-7.

Cloud Operations uses CloudTrail to monitor AWS deployments in the cloud by getting a history of AWS API calls of the cloud.gov account, including API calls made via the AWS Management Console, the command line tools, and higher-level AWS services.

See AU-7 (1).

cloud.gov pulls from multiple NTP sources including http://tf.nist.gov/tf-cgi/servers.cgi for all the cloud.gov servers to generate timestamps for audit records. All the cloud.gov NTP servers are synchronized with Amazon’s NTP canonical server.  These timestamps can be mapped to Coordinated Universal Time (UTC) or Greenwich Mean Time (GMT).

See AU-8 and AU-8 (1).

To maintain the integrity of log data, Cloud Operations carefully manages access around the generation and storage of audit log files. The ability to view or modify log data is restricted to Cloud Operations authorized users. Audit logs from CloudTrail are stored and protected in specified S3 buckets for cloud.gov, which are limited to read-only access and multifactor authentication by Cloud Operations staff.  This ensures the logs cannot be modified without proper authorization. 

Audit logs from the cloud.gov platform are only accessible to Cloud Operations personnel and can only be viewed via the ELK stack. Any backend access to the EC2 hosts supporting the ELK stack in violation of policy triggers an alert to the entire Cloud Operations team.

Further, the ElasticSearch component of ELK has been proxied such that our implementation filters and prevents modifications to existing logs via the HTTP PUT method, and only accepts the creation of new log entries via the HTTP POST method.

See AU-9.

The cloud.gov team implements a backup strategy to send all cloud.gov audit logs to encrypted S3 buckets where data is redundantly stored across multiple facilities and multiple devices in each facility. All S3 buckets are only accessible to authorized cloud.gov staff for logging and monitoring purposes. Cloud Operations performs weekly backups of all cloud.gov audit logs to the S3 buckets.

See AU-9 (2).

The System Owner authorizes access to management of audit functionality to only designated Cloud Operations staff.

See AU-9 (4).

Audit logs are kept according to NARA and GSA retention standards to provide support for after-the-fact investigations of security incidents and to meet regulatory and organizational information retention requirements. Our logging systems referenced above retain logs for 180 days online, and for an additional year in an offline system.

See AU-11.

cloud.gov provides comprehensive audit record generation capability for all components: CloudWatch Logs for AWS, metrics.fr.cloud.gov for cloud.gov metrics, and logs.fr.cloud.gov for applications on cloud.gov. 

Cloud Operations are responsible for maintaining the configuration that enforces the audit settings. 
Cloud Operations team members select which auditable events are to be audited by specific components of cloud.gov where audit capability is deployed.

See AU-12.
